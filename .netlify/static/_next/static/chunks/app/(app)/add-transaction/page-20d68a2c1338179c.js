(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[722],{5477:(e,t,s)=>{"use strict";s.d(t,{C:()=>c,x:()=>l});var a=s(95155),r=s(12115),n=s(56104),i=s(93004),d=s(35317);let o=(0,r.createContext)(void 0),c=e=>{let{children:t}=e,[s,c]=(0,r.useState)([]),[l,u]=(0,r.useState)(!0),[m,x]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=(0,i.hg)(n.j,e=>{x(e)});return()=>e()},[]),(0,r.useEffect)(()=>{if(m){u(!0);let e=(0,d.rJ)(n.db,"users",m.uid,"transactions"),t=(0,d.P)(e,(0,d.My)("date","desc"));(0,d.GG)(t).then(e=>{let t=[];e.forEach(e=>{let s=e.data();t.push({id:e.id,userId:m.uid,type:s.type,category:s.category,amount:s.amount,date:s.date instanceof d.Dc?s.date.toDate().toISOString().split("T")[0]:s.date,description:s.description})}),c(t)}).catch(e=>{console.error("Error fetching transactions from Firestore:",e),c([])}).finally(()=>{u(!1)})}else c([]),u(!1)},[m,n.db]);let p=(0,r.useCallback)(async e=>{if(!m)return void console.error("No user logged in to add transaction");try{let t=(0,d.rJ)(n.db,"users",m.uid,"transactions"),s={...e,date:d.Dc.fromDate(new Date(e.date))},a=await (0,d.gS)(t,s),r={...e,id:a.id,userId:m.uid};c(e=>[r,...e].sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime()))}catch(e){console.error("Error adding transaction to Firestore:",e)}},[m,n.db]);return(0,a.jsx)(o.Provider,{value:{transactions:s,addTransaction:p,loading:l},children:t})},l=()=>{let e=(0,r.useContext)(o);if(void 0===e)throw Error("useTransactions must be used within a TransactionProvider");return e}},35289:(e,t,s)=>{Promise.resolve().then(s.bind(s,80543))},80543:(e,t,s)=>{"use strict";s.d(t,{TransactionForm:()=>S});var a=s(95155),r=s(12115),n=s(62177),i=s(90221),d=s(55594),o=s(30285),c=s(62523),l=s(85057),u=s(59409),m=s(85511),x=s(14636),p=s(59434);let h=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,p.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});h.displayName="Textarea";var g=s(66695),y=s(5477),j=s(87481),f=s(40157);let v=(0,f.A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),b=(0,f.A)("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);var N=s(51920),w=s(83013);let k=d.Ik({type:d.k5(["income","expense"],{required_error:"Transaction type is required."}),category:d.Yj().min(1,"Category is required.").max(50,"Category too long."),amount:d.au.number().positive("Amount must be positive."),date:d.p6({required_error:"Date is required."}),description:d.Yj().max(100,"Description too long.").optional()}),C={income:["Salary","Freelance","Investment","Bonus","Gift","Other"],expense:["Food","Transport","Housing","Utilities","Entertainment","Healthcare","Shopping","Education","Other"]},S=()=>{let{addTransaction:e}=(0,y.x)(),{toast:t}=(0,j.dj)(),[s,d]=(0,r.useState)(!1),{control:f,handleSubmit:S,register:D,watch:E,reset:I,formState:{errors:T}}=(0,n.mN)({resolver:(0,i.u)(k),defaultValues:{type:"expense",category:"",amount:"",date:new Date,description:""}}),F=E("type");return(0,a.jsxs)(g.Zp,{className:"w-full max-w-2xl mx-auto shadow-xl",children:[(0,a.jsxs)(g.aR,{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(b,{className:"h-8 w-8 text-primary"})," ",(0,a.jsx)(g.ZB,{className:"text-2xl font-headline",children:"Record Transaction"})]}),(0,a.jsx)(g.BT,{children:"Add a new income or expense to your records."})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsxs)("form",{onSubmit:S(s=>{d(!0);try{e({...s,date:(0,w.GP)(s.date,"yyyy-MM-dd")}),t({title:"Transaction Added",description:"".concat("income"===s.type?"Income":"Expense"," of ").concat(s.amount.toLocaleString("en-IN",{style:"currency",currency:"INR"})," recorded."),action:(0,a.jsx)(v,{className:"text-green-500"})}),I()}catch(e){t({title:"Error",description:"Failed to add transaction. Please try again.",variant:"destructive"}),console.error(e)}finally{d(!1)}}),className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsx)(n.xI,{name:"type",control:f,render:e=>{let{field:t}=e;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"type",children:"Type"}),(0,a.jsxs)(u.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,a.jsx)(u.bq,{id:"type",children:(0,a.jsx)(u.yv,{placeholder:"Select type"})}),(0,a.jsxs)(u.gC,{children:[(0,a.jsx)(u.eb,{value:"income",children:"Income"}),(0,a.jsx)(u.eb,{value:"expense",children:"Expense"})]})]}),T.type&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:T.type.message})]})}}),(0,a.jsx)(n.xI,{name:"date",control:f,render:e=>{let{field:t}=e;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"date",children:"Date"}),(0,a.jsxs)(x.AM,{children:[(0,a.jsx)(x.Wv,{asChild:!0,children:(0,a.jsxs)(o.$,{id:"date",variant:"outline",className:(0,p.cn)("w-full justify-start text-left font-normal",!t.value&&"text-muted-foreground"),children:[(0,a.jsx)(N.A,{className:"mr-2 h-4 w-4"}),t.value?(0,w.GP)(t.value,"PPP"):(0,a.jsx)("span",{children:"Pick a date"})]})}),(0,a.jsx)(x.hl,{className:"w-auto p-0",children:(0,a.jsx)(m.V,{mode:"single",selected:t.value,onSelect:t.onChange,initialFocus:!0,disabled:e=>e>new Date||e<new Date("2000-01-01")})})]}),T.date&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:T.date.message})]})}})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"category",children:"Category"}),(0,a.jsx)(n.xI,{name:"category",control:f,render:e=>{let{field:t}=e;return(0,a.jsx)(c.p,{list:"category-suggestions",...t,id:"category",placeholder:"e.g., Food, Salary"})}}),(0,a.jsx)("datalist",{id:"category-suggestions",children:(F?C[F]:[]).map(e=>(0,a.jsx)("option",{value:e},e))}),T.category&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:T.category.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"amount",children:"Amount (INR)"}),(0,a.jsx)(c.p,{id:"amount",type:"number",step:"0.01",placeholder:"0.00",...D("amount")}),T.amount&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:T.amount.message})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.J,{htmlFor:"description",children:"Description (Optional)"}),(0,a.jsx)(h,{id:"description",placeholder:"e.g., Groceries for the week",...D("description")}),T.description&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:T.description.message})]}),(0,a.jsx)(o.$,{type:"submit",className:"w-full md:w-auto text-base py-3",disabled:s,children:s?"Adding...":"Add Transaction"})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,416,277,873,568,397,274,672,652,269,441,684,358],()=>t(35289)),_N_E=e.O()}]);